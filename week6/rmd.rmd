---
title: "Clustering"
author: "Akanksha Garlapati" 
date: "`r Sys.Date()`" 
output: word_document 
---
### 1. **Load the `tissue_gene_expression` dataset, remove row means, and compute distances**

We load the dataset, remove row means, and compute the distance.

```{r}
# Load the necessary libraries
library(dslabs)
library(tidyverse)

# Load the tissue_gene_expression dataset
data("tissue_gene_expression")

# Remove the row means
x <- sweep(tissue_gene_expression$x, 1, rowMeans(tissue_gene_expression$x))

# Compute the distance between each observation
d <- dist(x)
```

### 2. **Make a hierarchical clustering plot and label the tissue types**

We perform hierarchical clustering and plot it with labels for the tissue types.

```{r}
# Perform hierarchical clustering
h <- hclust(d)

# Plot the dendrogram with tissue types as labels
plot(h, labels = tissue_gene_expression$y, main = "Hierarchical Clustering of Tissue Types", xlab = "", cex = 0.6)
```

### 3. **Run k-means clustering with `K = 7` and compare to actual tissue types**

We run k-means clustering with 7 clusters, compare it to the actual tissue types, and repeat the algorithm to observe changes.

```{r}
# Set K = 7 for k-means clustering
set.seed(123)  # Set seed for reproducibility
k <- kmeans(x, centers = 7)

# Compare the identified clusters with actual tissue types
table(k$cluster, tissue_gene_expression$y)

# Run the k-means algorithm multiple times
set.seed(456)
k_repeated <- kmeans(x, centers = 7)
table(k_repeated$cluster, tissue_gene_expression$y)
```

### 4. **Select the 50 most variable genes, center predictors, and add color bars for tissue types**

We select the 50 most variable genes, center the predictors, and plot a heatmap with color bars for tissue types.

```{r}
library(matrixStats)
library(RColorBrewer)

# Select the 50 most variable genes
sds <- rowSds(tissue_gene_expression$x)
top_genes <- order(sds, decreasing = TRUE)[1:50]

# Create a subset of data with the 50 most variable genes
x_subset <- tissue_gene_expression$x[top_genes, ]

# Center the predictors (rows)
x_subset <- sweep(x_subset, 1, rowMeans(x_subset))

# Create a color bar based on tissue types
# Ensure the number of colors matches the number of columns (samples) in x_subset
tissue_colors <- brewer.pal(7, "Set1")[as.numeric(factor(tissue_gene_expression$y))]

# Now ensure tissue_colors matches the number of columns in x_subset
# The number of tissue types (samples) should match the number of columns
if(length(tissue_colors) != ncol(x_subset)) {
  tissue_colors <- tissue_colors[1:ncol(x_subset)]
}

# Plot the heatmap with color bar
heatmap(x_subset, col = brewer.pal(11, "RdBu"), ColSideColors = tissue_colors, scale = "row")

```
